<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Quáº£n lÃ½ Tiáº¿t kiá»‡m{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <nav class="navbar">
        <div class="container">
            <h1 class="logo">ğŸª™ Fin Compass</h1>
            <a href="{{ url_for('index') }}" class="nav-link">Trang chá»§</a>
            <!-- Link 'TÃ i khoáº£n' Ä‘Ã£ bá»‹ gá»¡ vÃ¬ chá»©c nÄƒng liÃªn káº¿t tÃ i khoáº£n khÃ´ng cÃ²n -->
             
            <a href="{{ url_for('analysis') }}" class="nav-link">ğŸ“Š PhÃ¢n tÃ­ch</a>

            {% if ai_enabled %}
            <a href="{{ url_for('ai_analyze') }}" class="nav-link">ğŸ¤– AI Advisor</a>
            {% endif %}

            {% if session.get('user_id') %}
                <a href="{{ url_for('profile') }}" class="nav-link">{{ current_user.username if current_user else 'TÃ i khoáº£n' }}</a>
                <a href="{{ url_for('logout') }}" class="nav-link">ÄÄƒng xuáº¥t</a>
            {% else %}
                <a href="{{ url_for('login') }}" class="nav-link">ÄÄƒng nháº­p</a>
                <a href="{{ url_for('register') }}" class="nav-link">ÄÄƒng kÃ½</a>
            {% endif %}
        </div>
    </nav>
    
    <main class="container">
        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                        <button onclick="this.parentElement.remove()">Ã—</button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </main>
    
    <footer class="footer">
        <p>&copy; 2026 FinFlow - Quáº£n lÃ½ Tiáº¿t kiá»‡m</p>
    </footer>
    
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    {% if session.get('user_id') %}
    <button class="fab" onclick="openTransactionModal()">+</button>
    {% endif %}
    <div id="transactionModal" class="modal hidden">
  <div class="modal-content">
    <h3>ThÃªm giao dá»‹ch</h3>

    <form method="POST" action="{{ url_for('create_transaction') }}">
      
      <!-- Loáº¡i giao dá»‹ch -->
      <div class="form-group">
        <label>Loáº¡i</label>
        <select name="type" id="transType" onchange="loadCategories()" required>
          <option value="expense">Chi tiÃªu</option>
          <option value="income">Thu nháº­p</option>
        </select>
      </div>

      <!-- Danh má»¥c -->
<div class="form-group">
  <label>Danh má»¥c</label>

  <div class="category-row">
    <select name="category_id" id="categorySelect" required></select>
    <button type="button" class="btn-add" onclick="showAddCategory()">â•</button>
  </div>

  <!-- ThÃªm nhanh danh má»¥c -->
  <div id="addCategoryBox" class="hidden">
    <input type="text" id="newCategoryName" placeholder="TÃªn danh má»¥c má»›i">
    <button type="button" onclick="createCategory()">ThÃªm</button>
  </div>
</div>


      <!-- Sá»‘ tiá»n -->
      <div class="form-group">
        <label>Sá»‘ tiá»n</label>
        <input type="number" name="amount" required min="1">
      </div>

      <!-- NgÃ y -->
      <div class="form-group">
        <label>NgÃ y</label>
        <input type="date" name="date" required>
      </div>

      <!-- Ghi chÃº -->
      <div class="form-group">
        <label>Ghi chÃº</label>
        <textarea name="note" rows="2"></textarea>
      </div>

      <div class="modal-actions">
        <button type="button" onclick="closeTransactionModal()">Huá»·</button>
        <button type="submit">LÆ°u</button>
      </div>

    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>
</html>